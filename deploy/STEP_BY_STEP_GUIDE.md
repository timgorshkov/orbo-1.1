# –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é Orbo –Ω–∞ Selectel

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º DevOps-–æ–ø—ã—Ç–æ–º. –ö–∞–∂–¥—ã–π —à–∞–≥ –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å–∞–Ω.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã (Windows)](#1-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–ª–æ–∫–∞–ª—å–Ω–æ–π-–º–∞—à–∏–Ω—ã-windows)
2. [–ü–µ—Ä–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É](#2-–ø–µ—Ä–≤–æ–µ-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ-–∫-—Å–µ—Ä–≤–µ—Ä—É)
3. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞](#3-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏-—Å–µ—Ä–≤–µ—Ä–∞)
4. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker](#4-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-docker)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Selectel S3](#5-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-selectel-s3)
6. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS](#6-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-dns)
7. [–†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#7-—Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
8. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL](#8-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-ssl)
9. [–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏](#9-–ø—Ä–æ–≤–µ—Ä–∫–∞-—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏)
10. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—ç–∫–∞–ø–æ–≤](#10-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–±—ç–∫–∞–ø–æ–≤)

---

## 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã (Windows)

### 1.1 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SSH-–∫–ª—é—á–∞

–û—Ç–∫—Ä–æ–π—Ç–µ **PowerShell** (–Ω–∞–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ –ø–æ–∏—Å–∫ Windows) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```powershell
# –°–æ–∑–¥–∞—ë–º –ø–∞–ø–∫—É –¥–ª—è –∫–ª—é—á–µ–π (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
mkdir -Force "$env:USERPROFILE\.ssh"

# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º SSH-–∫–ª—é—á
ssh-keygen -t ed25519 -C "orbo-selectel" -f "$env:USERPROFILE\.ssh\selectel_key"
```

–ö–æ–≥–¥–∞ –ø–æ–ø—Ä–æ—Å–∏—Ç **passphrase** ‚Äî –Ω–∞–∂–º–∏—Ç–µ Enter (–ø—É—Å—Ç–æ–π –ø–∞—Ä–æ–ª—å) –∏–ª–∏ –ø—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å (–ø—Ä–∏–¥—ë—Ç—Å—è –≤–≤–æ–¥–∏—Ç—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏).

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** —Å–æ–∑–¥–∞–Ω—ã –¥–≤–∞ —Ñ–∞–π–ª–∞:
- `C:\Users\–í–ê–®_–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨\.ssh\selectel_key` ‚Äî –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (–ù–ò–ö–û–ú–£ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ!)
- `C:\Users\–í–ê–®_–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨\.ssh\selectel_key.pub` ‚Äî –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (–µ–≥–æ –∫–æ–ø–∏—Ä—É–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä)

### 1.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH Config

–°–æ–∑–¥–∞–π—Ç–µ/–æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ SSH:

```powershell
notepad "$env:USERPROFILE\.ssh\config"
```

–í—Å—Ç–∞–≤—å—Ç–µ (–∑–∞–º–µ–Ω–∏—Ç–µ `YOUR_SERVER_IP` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π IP —Å–µ—Ä–≤–µ—Ä–∞ Selectel):

```
Host selectel-orbo
    HostName YOUR_SERVER_IP
    User deploy
    IdentityFile ~/.ssh/selectel_key
    ServerAliveInterval 60
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ** —Ñ–∞–π–ª (Ctrl+S) –∏ –∑–∞–∫—Ä–æ–π—Ç–µ –±–ª–æ–∫–Ω–æ—Ç.

### 1.3 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

–î–ª—è —É–¥–æ–±–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:

```powershell
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Scoop (–º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è Windows)
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
irm get.scoop.sh | iex

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ rsync –∏ s3cmd
scoop install git
scoop install s3cmd
```

---

## 2. –ü–µ—Ä–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É

### 2.1 –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –ø–∞—Ä–æ–ª—é

IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ –∏ –ø–∞—Ä–æ–ª—å –æ—Ç root –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç Selectel (–æ–±—ã—á–Ω–æ –Ω–∞ email).

```powershell
# –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è (–≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∫–æ–≥–¥–∞ –ø–æ–ø—Ä–æ—Å–∏—Ç)
ssh root@YOUR_SERVER_IP
```

### 2.2 –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ SSH-–∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–í–∞–∂–Ω–æ:** –í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ –î–û –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –≤—Ö–æ–¥–∞ –ø–æ –ø–∞—Ä–æ–ª—é!

–í **–Ω–æ–≤–æ–º** –æ–∫–Ω–µ PowerShell (–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ):

```powershell
# –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞
type "$env:USERPROFILE\.ssh\selectel_key.pub"
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –≤—ã–≤–æ–¥ (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `ssh-ed25519...`).

–í SSH-—Å–µ—Å—Å–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# –°–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª –¥–ª—è –∫–ª—é—á–µ–π
mkdir -p ~/.ssh
nano ~/.ssh/authorized_keys
```

–í—Å—Ç–∞–≤—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á, –∑–∞—Ç–µ–º:
- Ctrl+X (–≤—ã—Ö–æ–¥)
- Y (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å)
- Enter (–ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏–º—è —Ñ–∞–π–ª–∞)

### 2.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–æ –∫–ª—é—á—É

–ó–∞–∫—Ä–æ–π—Ç–µ SSH-—Å–µ—Å—Å–∏—é (`exit`) –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∑–∞–Ω–æ–≤–æ –±–µ–∑ –ø–∞—Ä–æ–ª—è:

```powershell
ssh root@YOUR_SERVER_IP -i "$env:USERPROFILE\.ssh\selectel_key"
```

–ï—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–∏–ª–∏—Å—å –±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è ‚Äî –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç!

---

## 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞

–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É (ssh root@...) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

### 3.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
apt update && apt upgrade -y
```

### 3.2 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

```bash
apt install -y ca-certificates curl gnupg git htop vim ufw fail2ban
```

### 3.3 –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –¥–µ–ø–ª–æ—è

```bash
# –°–æ–∑–¥–∞—ë–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è deploy
adduser --disabled-password --gecos "" deploy
usermod -aG sudo deploy

# –†–∞–∑—Ä–µ—à–∞–µ–º sudo –±–µ–∑ –ø–∞—Ä–æ–ª—è
echo "deploy ALL=(ALL) NOPASSWD:ALL" > /etc/sudoers.d/deploy
chmod 440 /etc/sudoers.d/deploy

# –ö–æ–ø–∏—Ä—É–µ–º SSH-–∫–ª—é—á–∏ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
mkdir -p /home/deploy/.ssh
cp /root/.ssh/authorized_keys /home/deploy/.ssh/
chown -R deploy:deploy /home/deploy/.ssh
chmod 700 /home/deploy/.ssh
chmod 600 /home/deploy/.ssh/authorized_keys
```

### 3.4 –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –≤—Ö–æ–¥–∞ –ø–æ –ø–∞—Ä–æ–ª—é

**–í–ê–ñ–ù–û:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Ö–æ–¥ –ø–æ –∫–ª—é—á—É —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–µ–∂–¥–µ —á–µ–º –æ—Ç–∫–ª—é—á–∞—Ç—å –ø–∞—Ä–æ–ª—å!

```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é SSH
sed -i 's/#PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config
sed -i 's/PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º SSH
systemctl restart sshd
```

### 3.5 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π–µ—Ä–≤–æ–ª–∞

```bash
# –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª–∞
ufw --force reset

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º
ufw default deny incoming
ufw default allow outgoing
ufw allow 22/tcp    # SSH
ufw allow 80/tcp    # HTTP
ufw allow 443/tcp   # HTTPS

# –í–∫–ª—é—á–∞–µ–º
ufw enable

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
ufw status verbose
```

### 3.6 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ fail2ban

```bash
cat > /etc/fail2ban/jail.local << 'EOF'
[DEFAULT]
bantime = 1h
findtime = 10m
maxretry = 5

[sshd]
enabled = true
maxretry = 3
EOF

systemctl enable fail2ban
systemctl restart fail2ban
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø–æ –∫–ª—é—á—É:

```powershell
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
ssh selectel-orbo  # –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥)
```

---

## 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º **deploy**:

```bash
# –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ deploy
su - deploy

# –ò–ª–∏ –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∑–∞–Ω–æ–≤–æ
# ssh selectel-orbo
```

### 4.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker

```bash
# –î–æ–±–∞–≤–ª—è–µ–º GPG-–∫–ª—é—á Docker
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg

# –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
  $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Docker
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# –î–æ–±–∞–≤–ª—è–µ–º —Å–µ–±—è –≤ –≥—Ä—É–ø–ø—É docker (—á—Ç–æ–±—ã –Ω–µ –ø–∏—Å–∞—Ç—å sudo)
sudo usermod -aG docker deploy

# –í–ê–ñ–ù–û: –≤—ã–π–¥–∏—Ç–µ –∏ –≤–æ–π–¥–∏—Ç–µ –∑–∞–Ω–æ–≤–æ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≥—Ä—É–ø–ø
exit
```

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º
docker --version
docker compose version
docker run hello-world
```

---

## 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Selectel S3

### 5.1 –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (bucket)

1. –û—Ç–∫—Ä–æ–π—Ç–µ [my.selectel.ru](https://my.selectel.ru)
2. –í –ª–µ–≤–æ–º –º–µ–Ω—é: **–û–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**
3. –ù–∞–∂–º–∏—Ç–µ **–°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - –ò–º—è: `orbo-materials`
   - –†–µ–≥–∏–æ–Ω: `ru-1` (–∏–ª–∏ –±–ª–∏–∂–∞–π—à–∏–π –∫ —Å–µ—Ä–≤–µ—Ä—É)
   - –ö–ª–∞—Å—Å —Ö—Ä–∞–Ω–µ–Ω–∏—è: `Standard`
   - –¢–∏–ø –¥–æ—Å—Ç—É–ø–∞: **–ü—Ä–∏–≤–∞—Ç–Ω—ã–π**
5. –ù–∞–∂–º–∏—Ç–µ **–°–æ–∑–¥–∞—Ç—å**

### 5.2 –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –í –ª–µ–≤–æ–º –º–µ–Ω—é: **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** ‚Üí **–°–µ—Ä–≤–∏—Å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**
2. –ù–∞–∂–º–∏—Ç–µ **–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: `orbo-s3-user`
   - –†–æ–ª—å: **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞**
4. –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
5. –°–æ–∑–¥–∞–π—Ç–µ **EC2 credentials**:
   - –ù–∞–∂–º–∏—Ç–µ **–î–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á**
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ **Access Key ID** –∏ **Secret Access Key**

‚ö†Ô∏è **Secret Key –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!** –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ –Ω–∞–¥—ë–∂–Ω–æ.

### 5.3 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ s3cmd –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ

```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
cd "C:\Cursor WS\orbo-1.1.1\orbo-1.1\deploy\scripts"
.\s3cfg-setup.ps1
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `C:\Users\–í–ê–®_–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨\.s3cfg`:

```ini
[default]
access_key = –í–ê–®_ACCESS_KEY
secret_key = –í–ê–®_SECRET_KEY
host_base = s3.storage.selcloud.ru
host_bucket = %(bucket)s.s3.storage.selcloud.ru
use_https = True
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

```powershell
s3cmd ls
# –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å: s3://orbo-materials
```

---

## 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS

### 6.1 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ DNS-–∑–∞–ø–∏—Å–µ–π

–í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞—à–∏–º –¥–æ–º–µ–Ω–æ–º (—Ç–∞–º –≥–¥–µ –ø–æ–∫—É–ø–∞–ª–∏ –¥–æ–º–µ–Ω):

| –¢–∏–ø | –ò–º—è | –ó–Ω–∞—á–µ–Ω–∏–µ | TTL |
|-----|-----|----------|-----|
| A | @ | IP_–°–ï–†–í–ï–†–ê | 3600 |
| A | www | IP_–°–ï–†–í–ï–†–ê | 3600 |

–ü—Ä–∏–º–µ—Ä –¥–ª—è –¥–æ–º–µ–Ω–∞ `orbo.ru`:
- `@` –æ–∑–Ω–∞—á–∞–µ—Ç —Å–∞–º –¥–æ–º–µ–Ω `orbo.ru`
- `www` —Å–æ–∑–¥–∞—Å—Ç `www.orbo.ru`

### 6.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS

DNS-–∑–∞–ø–∏—Å–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –æ—Ç 5 –º–∏–Ω—É—Ç –¥–æ 48 —á–∞—Å–æ–≤. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–∂–Ω–æ:

```powershell
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
nslookup yourdomain.ru
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.

---

## 7. –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 7.1 –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh selectel-orbo

# –°–æ–∑–¥–∞—ë–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫
mkdir -p ~/orbo/{app,nginx/logs,data/postgres,data/certbot,scripts,backups}
```

### 7.2 –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

–ù–∞ **–ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ** –≤ PowerShell:

```powershell
# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd "C:\Cursor WS\orbo-1.1.1\orbo-1.1"

# –ö–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –¥–µ–ø–ª–æ—è
scp deploy/docker-compose.yml selectel-orbo:~/orbo/
scp deploy/Dockerfile selectel-orbo:~/orbo/app/
scp deploy/nginx/nginx.conf selectel-orbo:~/orbo/nginx/
scp deploy/env.example selectel-orbo:~/orbo/.env
scp deploy/scripts/*.sh selectel-orbo:~/orbo/scripts/

# –î–µ–ª–∞–µ–º —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
ssh selectel-orbo "chmod +x ~/orbo/scripts/*.sh"
```

### 7.3 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
cd ~/orbo
nano .env
```

–ó–∞–º–µ–Ω–∏—Ç–µ –≤—Å–µ placeholder-–∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ:

```bash
# –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –ø–∞—Ä–æ–ª—å –ë–î
openssl rand -base64 32
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ POSTGRES_PASSWORD

# –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ webhook secret
openssl rand -hex 32
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ TELEGRAM_WEBHOOK_SECRET
```

**–ö–ª—é—á–µ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è:**
- `POSTGRES_PASSWORD` ‚Äî —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å
- `NEXT_PUBLIC_APP_URL` ‚Äî –≤–∞—à –¥–æ–º–µ–Ω (https://yourdomain.ru)
- `SELECTEL_ACCESS_KEY` ‚Äî –∏–∑ —à–∞–≥–∞ 5.2
- `SELECTEL_SECRET_KEY` ‚Äî –∏–∑ —à–∞–≥–∞ 5.2
- `TELEGRAM_BOT_TOKEN` ‚Äî –æ—Ç @BotFather
- `SUPABASE_*` ‚Äî —Ç–µ–∫—É—â–∏–µ credentials (–≤—Ä–µ–º–µ–Ω–Ω–æ, –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏)

### 7.4 –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞

–ù–∞ **–ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ**:

```powershell
# –ß–µ—Ä–µ–∑ Git Bash –∏–ª–∏ WSL (rsync –±—ã—Å—Ç—Ä–µ–µ)
rsync -avz --progress --delete `
    --exclude 'node_modules' `
    --exclude '.next' `
    --exclude '.git' `
    --exclude 'deploy' `
    --exclude '.env*' `
    ./ deploy@selectel-orbo:~/orbo/app/
```

–ò–ª–∏ —á–µ—Ä–µ–∑ scp (–º–µ–¥–ª–µ–Ω–Ω–µ–µ):

```powershell
scp -r . selectel-orbo:~/orbo/app/
```

### 7.5 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ nginx.conf

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –∑–∞–º–µ–Ω–∏—Ç–µ `YOUR_DOMAIN.ru` –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω:

```bash
cd ~/orbo
sed -i 's/YOUR_DOMAIN\.ru/my.orbo.ru/g' nginx/nginx.conf
```

### 7.6 –ó–∞–ø—É—Å–∫ PostgreSQL

```bash
cd ~/orbo
docker compose up -d postgres

# –ñ–¥—ë–º ~15 —Å–µ–∫—É–Ω–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
sleep 15

# –ü—Ä–æ–≤–µ—Ä—è–µ–º
docker compose logs postgres
docker exec orbo_postgres pg_isready -U orbo
```

### 7.7 –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 5-10 –º–∏–Ω—É—Ç)
docker compose build app

# –ó–∞–ø—É—Å–∫
docker compose up -d app

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏
docker compose logs -f app
# Ctrl+C —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ –∏–∑ –ª–æ–≥–æ–≤
```

---

## 8. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL

‚ö†Ô∏è **–í—ã–ø–æ–ª–Ω—è–π—Ç–µ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ DNS** (–¥–æ–º–µ–Ω –¥–æ–ª–∂–µ–Ω —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞)

### 8.1 –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ SSL

```bash
cd ~/orbo
./scripts/ssl-setup.sh yourdomain.ru your@email.com
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –°–æ–∑–¥–∞—Å—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π nginx-–∫–æ–Ω—Ñ–∏–≥
2. –ü–æ–ª—É—á–∏—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Let's Encrypt
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç nginx —Å SSL
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

### 8.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
curl -I https://yourdomain.ru
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å `HTTP/2 200` –∏–ª–∏ `301/302` redirect.

---

## 9. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### 9.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
docker compose ps
```

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Å—Ç–∞—Ç—É—Å–µ `Up` –∏ `healthy`.

### 9.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker compose logs app

# –õ–æ–≥–∏ nginx
docker compose logs nginx

# –õ–æ–≥–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
docker compose logs postgres
```

### 9.3 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

```bash
# Health check
curl http://localhost:3000/api/health

# –ß–µ—Ä–µ–∑ nginx (–µ—Å–ª–∏ SSL –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
curl https://yourdomain.ru/api/health
```

### 9.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

–û—Ç–∫—Ä–æ–π—Ç–µ `https://yourdomain.ru` ‚Äî –¥–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## 10. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—ç–∫–∞–ø–æ–≤

### 10.1 –¢–µ—Å—Ç–æ–≤—ã–π –±—ç–∫–∞–ø

```bash
cd ~/orbo
./scripts/backup.sh
```

### 10.2 –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã

```bash
# –û—Ç–∫—Ä—ã–≤–∞–µ–º crontab
crontab -e
```

–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É (–±—ç–∫–∞–ø –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00):

```
0 3 * * * /home/deploy/orbo/scripts/backup.sh >> /home/deploy/orbo/scripts/backup.log 2>&1
```

### 10.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –±—ç–∫–∞–ø–æ–≤

```bash
ls -la ~/orbo/backups/
```

---

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ù–µ –º–æ–≥—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –ø–æ SSH

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–ª—é—á –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π: `ssh -v selectel-orbo`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–µ—Ä–≤–æ–ª: `sudo ufw status`

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –°–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏
docker compose logs app

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
docker compose exec app env | grep -E "(DATABASE|SUPABASE)"
```

### –û—à–∏–±–∫–∞ SSL/DNS

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ DNS –Ω–∞—Å—Ç—Ä–æ–µ–Ω: `nslookup yourdomain.ru`
2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è DNS (–¥–æ 48 —á–∞—Å–æ–≤)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ nginx: `docker compose exec nginx nginx -t`

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose ps postgres

# –°–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏
docker compose logs postgres

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
docker exec -it orbo_postgres psql -U orbo -d orbo
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker compose restart app

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker compose build app && docker compose up -d app

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ–≥–æ
docker compose down

# –û—á–∏—Å—Ç–∫–∞ Docker (–æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –º–µ—Å—Ç–æ)
docker system prune -a

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats
htop

# –ú–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ
df -h
```

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏

- Selectel: support@selectel.ru –∏–ª–∏ —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Selectel: docs.selectel.ru

---

**–ì–æ—Ç–æ–≤–æ!** –í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ –Ω–∞ Selectel. üéâ






