# –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Telegram-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (6 –∏–∑ 7 –∑–∞–¥–∞—á)

### 1. –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î ‚úÖ
**–§–∞–π–ª:** `db/migrations/23_organization_invites.sql`
- –¢–∞–±–ª–∏—Ü–∞ `organization_invites` –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π
- –¢–∞–±–ª–∏—Ü–∞ `organization_invite_uses` –¥–ª—è –∞—É–¥–∏—Ç–∞
- –§—É–Ω–∫—Ü–∏–∏: `generate_invite_token()`, `is_invite_valid()`
- RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
- –¢—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `updated_at`

### 2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç TelegramLogin ‚úÖ
**–§–∞–π–ª:** `components/auth/telegram-login.tsx`
- –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π Telegram Login Widget
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ö–µ—à–∞ –æ—Ç Telegram
- Callback –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
- TypeScript —Ç–∏–ø—ã

### 3. API endpoint –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ‚úÖ
**–§–∞–π–ª:** `app/api/auth/telegram/route.ts`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç Telegram
- –°–æ–∑–¥–∞–Ω–∏–µ/–ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û–±—Ä–∞–±–æ—Ç–∫–∞ invite tokens
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ —á–µ—Ä–µ–∑ magic link
- –°–≤—è–∑–∫–∞ —Å `participants` –ø–æ `tg_user_id`

### 4. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π ‚úÖ
**–§–∞–π–ª—ã:**
- `app/join/[org]/[token]/page.tsx` (—Å–µ—Ä–≤–µ—Ä–Ω—ã–π)
- `app/join/[org]/[token]/client.tsx` (–∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
- –ö—Ä–∞—Å–∏–≤—ã–π UI —Å –ª–æ–≥–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 5. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–æ–≥–∏–Ω–∞ —Å Telegram ‚úÖ
**–§–∞–π–ª:** `app/login/telegram/page.tsx`
- Telegram Login Widget
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤
- –†–µ–¥–∏—Ä–µ–∫—Ç –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 6. UI —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è–º–∏ ‚úÖ
**–§–∞–π–ª—ã:**
- `app/app/[org]/settings/invites/page.tsx`
- `components/settings/invites-manager.tsx`
- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π
- –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π

## üöß –í —Ä–∞–±–æ—Ç–µ (1 –∏–∑ 7)

### 7. API endpoints –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π
**–ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å:**
- `app/api/organizations/[id]/invites/route.ts` (GET, POST)
- `app/api/organizations/[id]/invites/[inviteId]/route.ts` (DELETE, PUT)

## üìã –ß—Ç–æ –¥–∞–ª—å—à–µ

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è MVP:
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å API endpoints –¥–ª—è CRUD –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ "–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è" –≤ –º–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫
3. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—É–±–ª–∏—á–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏
4. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `.env.example` —Å `NEXT_PUBLIC_TELEGRAM_BOT_USERNAME`
5. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (—É–ª—É—á—à–µ–Ω–∏—è):
- Telegram-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä—è–º–æ –Ω–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö —Å–æ–±—ã—Ç–∏–π
- QR-–∫–æ–¥—ã –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π
- Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–∞—Ö

## üéØ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –î–ª—è –∞–¥–º–∏–Ω–∞:
1. –ü–µ—Ä–µ–π—Ç–∏ –≤ `/app/[org]/settings/invites`
2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ (–≤—ã–±—Ä–∞—Ç—å —Ç–∏–ø –¥–æ—Å—Ç—É–ø–∞, —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è)
3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º

### –î–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–∞:
1. –ü–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫—É-–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç –∞–¥–º–∏–Ω–∞
2. –û—Ç–∫—Ä—ã—Ç—å —Å—Å—ã–ª–∫—É `/join/[org]/[token]`
3. –ù–∞–∂–∞—Ç—å "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram"
4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤ Telegram –∑–∞ 1 –∫–ª–∏–∫
5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é

### –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–∑ Telegram-–≥—Ä—É–ø–ø—ã:
1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ `/login/telegram`
2. –ù–∞–∂–∞—Ç—å "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram"
3. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç –µ–≥–æ –ø–æ `tg_user_id` –≤ `participants`
4. –°–æ–∑–¥–∞—Å—Ç `auth.users` –∏ —Å–≤—è–∂–µ—Ç —Å `participants`

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```env
NEXT_PUBLIC_TELEGRAM_BOT_USERNAME=your_bot_name
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞ –≤ BotFather:
```
/setdomain
yourapp.com
```

---

**–°—Ç–∞—Ç—É—Å:** 85% –≥–æ—Ç–æ–≤–æ
**–î–∞—Ç–∞:** 2025-10-09

