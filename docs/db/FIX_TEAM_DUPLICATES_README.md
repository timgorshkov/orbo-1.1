# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–µ–π –≤ –∫–æ–º–∞–Ω–¥–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

## üîç –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –î—É–±–ª—å –≤–ª–∞–¥–µ–ª—å—Ü–∞
- **Tim Gorshkov** (owner, `9bb4b601...`) - ‚úÖ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç
- **–¢–∏–º–æ—Ñ–µ–π –ì–æ—Ä—à–∫–æ–≤** (admin-shadow, `aaa800d9...`) - ‚ùå –¥—É–±–ª—å —Ç–æ–≥–æ –∂–µ —á–µ–ª–æ–≤–µ–∫–∞
- **–û–±–∞ –∏–º–µ—é—Ç** `tg_user_id: 154588486` (—ç—Ç–æ –≤—ã!)

**–ü—Ä–∏—á–∏–Ω–∞:** Telegram-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–ª–∞ —Ç–µ–Ω–µ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å, –∫–æ–≥–¥–∞ —É–≤–∏–¥–µ–ª–∞ –≤–∞—Å –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤ –≥—Ä—É–ø–ø–∞—Ö.

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –¢–∏–º—É—Ä –ì–æ–ª–∏—Ü—ã–Ω - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π user_id
- –í `memberships`: `543b9ddd...` ‚ùå
- –í `user_telegram_accounts`: `d6495527...` ‚úÖ
- **–°–≤—è–∑—å –Ω–∞—Ä—É—à–µ–Ω–∞** ‚Üí —Å—Ç–∞—Ç—É—Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–µ–≤–µ—Ä–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –°—Ç–∞—Ç—É—Å—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- VIEW `organization_admins` –¥–∂–æ–π–Ω–∏—Ç `user_telegram_accounts` –ø–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É `user_id`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: `has_verified_telegram: false`, —Ö–æ—Ç—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `true`

## üõ†Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:

1. ‚úÖ –£–¥–∞–ª—è–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏–π `membership` —Å `role='admin'` –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞
2. ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç `participant` - –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `user_id` –≤–ª–∞–¥–µ–ª—å—Ü–∞
3. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç `user_id` –¥–ª—è –¢–∏–º—É—Ä–∞ –ì–æ–ª–∏—Ü—ã–Ω–∞ –≤ `memberships` –∏ `participants`
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç
```bash
# –í Supabase SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
db/fix_team_duplicates.sql
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
–°–∫—Ä–∏–ø—Ç –≤ –∫–æ–Ω—Ü–µ –ø–æ–∫–∞–∂–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å —Ç–µ–∫—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º `organization_admins`.

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
- 1 owner (Tim Gorshkov)
- 1 admin (–¢–∏–º—É—Ä –ì–æ–ª–∏—Ü—ã–Ω) —Å `has_verified_telegram: true`
- **–ë–ï–ó –¥—É–±–ª—è** "–¢–∏–º–æ—Ñ–µ–π –ì–æ—Ä—à–∫–æ–≤"

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ UI
–û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –±–ª–æ–∫ "–ö–æ–º–∞–Ω–¥–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏".

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
- **–í–ª–∞–¥–µ–ª–µ—Ü:** Tim Gorshkov, ‚úÖ Email –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω, ‚úÖ Telegram –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã (1):** –¢–∏–º—É—Ä –ì–æ–ª–∏—Ü—ã–Ω, ‚úÖ Telegram –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω

### –®–∞–≥ 4: –û—á–∏—Å—Ç–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–ï—Å–ª–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏–π `user_id` (`aaa800d9...`) –æ—Å—Ç–∞–ª—Å—è –≤ `auth.users`, —É–¥–∞–ª–∏—Ç–µ –µ–≥–æ:

**–°–ø–æ—Å–æ–± 1: Dashboard**
- Supabase Dashboard ‚Üí Authentication ‚Üí Users
- –ù–∞–π–¥–∏—Ç–µ `aaa800d9-8fa6-47ac-a716-f2bc7d89d862`
- Delete user

**–°–ø–æ—Å–æ–± 2: SQL**
```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –æ—Å—Ç–∞–ª–∏—Å—å –ª–∏ —Å–≤—è–∑–∏
SELECT COUNT(*) FROM memberships WHERE user_id = 'aaa800d9-8fa6-47ac-a716-f2bc7d89d862';
SELECT COUNT(*) FROM participants WHERE user_id = 'aaa800d9-8fa6-47ac-a716-f2bc7d89d862';

-- –ï—Å–ª–∏ –æ–±–µ –≤–µ—Ä–Ω—É–ª–∏ 0, –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å
DELETE FROM auth.users WHERE id = 'aaa800d9-8fa6-47ac-a716-f2bc7d89d862';
```

## ‚ö†Ô∏è –ß—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫:

### –û—à–∏–±–∫–∞: "duplicate key value violates unique constraint"
–ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç —É–ø–∞–¥—ë—Ç —Å —ç—Ç–æ–π –æ—à–∏–±–∫–æ–π, –∑–Ω–∞—á–∏—Ç –∑–∞–ø–∏—Å—å —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º `user_id` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ü—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –≤—Ä—É—á–Ω—É—é
DELETE FROM memberships 
WHERE org_id = 'a3e8bc8f-8171-472c-a955-2f7878aed6f1'
  AND user_id = 'aaa800d9-8fa6-47ac-a716-f2bc7d89d862';

DELETE FROM memberships 
WHERE org_id = 'a3e8bc8f-8171-472c-a955-2f7878aed6f1'
  AND user_id = '543b9ddd-a31e-44f9-972b-6ab63341b8db';
```

### –°—Ç–∞—Ç—É—Å—ã –≤—Å—ë –µ—â—ë –Ω–µ–≤–µ—Ä–Ω—ã –ø–æ—Å–ª–µ —Å–∫—Ä–∏–ø—Ç–∞
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ VIEW `organization_admins` –æ–±–Ω–æ–≤–ª—ë–Ω:

```sql
-- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ view
\d+ organization_admins

-- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ view (–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é)
-- db/migrations/060_fix_organization_admins_verification.sql
```

## üìã –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫:

- [ ] –°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
- [ ] –í —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ 1 owner + 1 admin (–±–µ–∑ –¥—É–±–ª—è)
- [ ] –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥—É–±–ª—å –∏—Å—á–µ–∑
- [ ] –°—Ç–∞—Ç—É—Å—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –¢–∏–º—É—Ä –ì–æ–ª–∏—Ü—ã–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `‚úÖ Telegram –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω`
- [ ] (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£–¥–∞–ª—ë–Ω –¥—É–±–ª–∏—Ä—É—é—â–∏–π user –∏–∑ auth.users

---

**–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫,** –ø—Ä–∏—à–ª–∏—Ç–µ –≤—ã–≤–æ–¥ —Å–∫—Ä–∏–ø—Ç–∞ –∏ —è –ø–æ–º–æ–≥—É!


