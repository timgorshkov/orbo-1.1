# –ü–ª–∞–Ω –æ—á–∏—Å—Ç–∫–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ë–î - –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞

## üéØ –ß—Ç–æ —è –ø—Ä–µ–¥–ª–∞–≥–∞—é —Å–¥–µ–ª–∞—Ç—å

### ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é 42 (–±–µ–∑–æ–ø–∞—Å–Ω–æ)
```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤ Supabase SQL Editor
db/migrations/42_cleanup_unused_tables.sql
```

**–ß—Ç–æ —É–¥–∞–ª–∏—Ç—Å—è:**
- `telegram_activity_events` - –¥—É–±–ª–∏–∫–∞—Ç `activity_events`, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- `telegram_identities` - –∑–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞ `user_telegram_accounts`, –∫–æ–¥ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
- `telegram_updates` - —Å–æ–∑–¥–∞–Ω–∞, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—Å—è:**
- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- CHECK constraints –¥–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

**–†–∏—Å–∫–∏:** üü¢ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ (—Ç–∞–±–ª–∏—Ü—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∫–æ–¥–µ)

---

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–æ–µ–∫—Ç–∞ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ)

### –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
1. **organizations** - –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏/–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
2. **memberships** - —Å–≤—è–∑—å user ‚Üî org + —Ä–æ–ª–∏
3. **participants** - —É—á–∞—Å—Ç–Ω–∏–∫–∏ (CRM)
4. **user_telegram_accounts** - —Å–≤—è–∑—å user ‚Üî Telegram ID

### Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
5. **telegram_groups** - Telegram –≥—Ä—É–ø–ø—ã
6. **org_telegram_groups** - —Å–≤—è–∑—å org ‚Üî –≥—Ä—É–ø–ø—ã (many-to-many)
7. **participant_groups** - —Å–≤—è–∑—å participant ‚Üî –≥—Ä—É–ø–ø—ã
8. **activity_events** - —Å–æ–±—ã—Ç–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (—Å–æ–æ–±—â–µ–Ω–∏—è, join/leave)
9. **participant_messages** - —Ç–µ–∫—Å—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π (–¥–ª—è AI –∞–Ω–∞–ª–∏–∑–∞)
10. **telegram_auth_codes** - –∫–æ–¥—ã –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞

### –°–æ–±—ã—Ç–∏—è
11. **events** - –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
12. **event_registrations** - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
13. **event_telegram_notifications** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö

### –ú–∞—Ç–µ—Ä–∏–∞–ª—ã
14. **material_pages** - –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π (–∑–∞–º–µ–Ω–∏–ª–∞ material_folders/items)

---

## ‚ö†Ô∏è –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ä—É—á–Ω—É—é

### 1. –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ
SELECT COUNT(*) FROM material_folders;
SELECT COUNT(*) FROM material_items;
SELECT COUNT(*) FROM material_access;
```

**–ï—Å–ª–∏ –≤—Å–µ = 0:** –ë–µ–∑–æ–ø–∞—Å–Ω–æ —É–¥–∞–ª–∏—Ç—å  
**–ï—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ:** –ù—É–∂–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ `material_pages`

### 2. –¢–∞–±–ª–∏—Ü–∞ telegram_bots
```sql
SELECT COUNT(*) FROM telegram_bots;
```

**–ï—Å–ª–∏ = 0 –∏ –Ω–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è per-org –±–æ—Ç—ã:** –£–¥–∞–ª–∏—Ç—å  
**–ï—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:** –û—Å—Ç–∞–≤–∏—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å

---

## üöÄ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- ~35 —Ç–∞–±–ª–∏—Ü
- 5-7 –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ç–∞–±–ª–∏—Ü
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- ~28-30 —Ç–∞–±–ª–∏—Ü
- –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–Ω–æ–≤—ã–µ –∏–Ω–¥–µ–∫—Å—ã)
- –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö (CHECK constraints)

**–£–ø—Ä–æ—â–µ–Ω–∏–µ —Å—Ö–µ–º—ã:** ~20%  
**–†–∏—Å–∫–∏:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ 42

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–°–µ–π—á–∞—Å (–±–µ–∑–æ–ø–∞—Å–Ω–æ):**
   - –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é 42
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

2. **–ü–æ—Ç–æ–º (—Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏):**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `material_folders/items/access`
   - –†–µ—à–∏—Ç—å —Å—É–¥—å–±—É `telegram_bots`
   - –ï—Å–ª–∏ –≤—Å–µ –æ–∫ - —É–¥–∞–ª–∏—Ç—å –∏ —ç—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã

3. **–í –±—É–¥—É—â–µ–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
   - –ö–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å 42 –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ –æ–¥–∏–Ω —Ñ–∞–π–ª –¥–ª—è –Ω–æ–≤—ã—Ö –¥–µ–ø–ª–æ–µ–≤
   - –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫–æ –≤—Å–µ–º —Ç–∞–±–ª–∏—Ü–∞–º
   - –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–º–µ–Ω—É `group_metrics` –Ω–∞ materialized view

---

## ‚ùì –í–æ–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è

1. **–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª per-org Telegram –±–æ—Ç–æ–≤?**
   - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí —É–¥–∞–ª–∏—Ç—å `telegram_bots`
   - –ï—Å–ª–∏ –¥–∞ ‚Üí —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

2. **–ù—É–∂–Ω–∞ –ª–∏ –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º?**
   - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí —É–¥–∞–ª–∏—Ç—å `material_access`
   - –ï—Å–ª–∏ –¥–∞ ‚Üí –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å `material_pages`

3. **–ù—É–∂–Ω–∞ –ª–∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ Telegram updates?**
   - –ï—Å–ª–∏ –¥–∞ ‚Üí —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Redis/in-memory
   - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí —É–∂–µ —É–¥–∞–ª–µ–Ω–æ –≤ –º–∏–≥—Ä–∞—Ü–∏–∏ 42

---

**–ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é!** üéâ

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω—ã –∏ –Ω–µ —Å–ª–æ–º–∞—é—Ç —Ç–µ–∫—É—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª.


