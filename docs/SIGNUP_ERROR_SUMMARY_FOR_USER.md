# üî¥ –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å

**–ü—Ä–æ–±–ª–µ–º–∞:** "Database error finding user" –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏  
**–í—Ä–µ–º—è –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ:** 5-10 –º–∏–Ω—É—Ç

---

## ‚ö° –ù–ê–ß–ù–ò–¢–ï –° –≠–¢–û–ì–û (5 –º–∏–Ω—É—Ç)

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard

**[https://supabase.com/dashboard](https://supabase.com/dashboard)** ‚Üí –≤–∞—à –ø—Ä–æ–µ–∫—Ç

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL Configuration

**Settings ‚Üí Auth ‚Üí URL Configuration:**

```
Site URL:
https://app.orbo.ru

Redirect URLs (–Ω–∞–∂–º–∏—Ç–µ Add URL –¥–ª—è –∫–∞–∂–¥–æ–≥–æ):
https://app.orbo.ru/**
https://app.orbo.ru/auth-callback
http://localhost:3000/**
```

‚ö†Ô∏è **–í–ê–ñ–ù–û:** –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞–∂–º–∏—Ç–µ **Save**!

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Email Provider

**Authentication ‚Üí Providers:**

- [x] **Email** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–í–ö–õ–Æ–ß–ï–ù** (–∑–µ–ª—ë–Ω—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å)

**Settings ‚Üí Auth ‚Üí Email Auth:**

- [x] **Enable Email Signup:** ON
- [x] **Confirm Email:** –º–æ–∂–Ω–æ –≤—ã–∫–ª—é—á–∏—Ç—å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- [x] **Enable Email OTP:** ON

–ù–∞–∂–º–∏—Ç–µ **Save**

### 4. SMTP Settings

**Settings ‚Üí Auth ‚Üí SMTP Settings:**

**–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
- [ ] **Enable Custom SMTP:** **OFF** (–∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Supabase)

**–î–ª—è production (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ Mailgun):**
- [x] **Enable Custom SMTP:** ON
- Host: `smtp.mailgun.org`
- Port: `587`
- Username: `postmaster@YOUR_DOMAIN`
- Password: (–≤–∞—à Mailgun API key)

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞

1. **–û—á–∏—Å—Ç–∏—Ç–µ cookies** (–∏–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–∂–∏–º –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ)
2. –û—Ç–∫—Ä–æ–π—Ç–µ **https://app.orbo.ru/signup**
3. –í–≤–µ–¥–∏—Ç–µ email
4. –ù–∞–∂–º–∏—Ç–µ "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è"

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úâÔ∏è –û—Ç–ª–∏—á–Ω–æ! –ú—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ —Å—Å—ã–ª–∫—É –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–∞ –≤–∞—à email.
```

**–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –≤—Å—ë –µ—â—ë –µ—Å—Ç—å** ‚Üí –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –®–∞–≥—É 5

---

## üîç –®–∞–≥ 5: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–µ—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ)

### A. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
2. –í–∫–ª–∞–¥–∫–∞ **Network**
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
4. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å `/auth/v1/otp` (–∫—Ä–∞—Å–Ω—ã–π, 500 –æ—à–∏–±–∫–∞)
5. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ ‚Üí –≤–∫–ª–∞–¥–∫–∞ **Response**
6. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏** –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ

### B. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Supabase Auth Logs

1. **Supabase Dashboard** ‚Üí **Logs** ‚Üí **Auth Logs**
2. –§–∏–ª—å—Ç—Ä: `level:error`
3. –ù–∞–π–¥–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –ø–æ–ø—ã—Ç–∫—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
4. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏** –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ

### C. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π SQL —Å–∫—Ä–∏–ø—Ç

1. **Supabase SQL Editor**
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –∫–æ–¥ –∏–∑ `db/DIAGNOSE_SIGNUP_ISSUE.sql`
3. –í—Å—Ç–∞–≤—å—Ç–µ –∏ –Ω–∞–∂–º–∏—Ç–µ **Run**
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ Notice/Info –ø–∞–Ω–µ–ª–∏
5. **–°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç** –∏–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞–∂–Ω—ã–µ Notice –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ

---

## üõ†Ô∏è –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–µ—Å–ª–∏ —Å–æ–≤—Å–µ–º –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)

–ü–æ–∫–∞ –∏—â–µ–º —Ä–µ—à–µ–Ω–∏–µ, –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—Ä—É—á–Ω—É—é:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Supabase Dashboard

1. **Supabase Dashboard** ‚Üí **Authentication** ‚Üí **Users**
2. –ù–∞–∂–º–∏—Ç–µ **Add user** (–∏–ª–∏ **Invite user**)
3. –í–≤–µ–¥–∏—Ç–µ:
   - Email: –≤–∞—à email
   - Password: –ª—é–±–æ–π –ø–∞—Ä–æ–ª—å
   - [x] **Auto Confirm User** - –≤–∫–ª—é—á–∏—Ç—å
4. –ù–∞–∂–º–∏—Ç–µ **Create user**

–¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏—Ç–µ –Ω–∞ **https://app.orbo.ru/signin** —Å —ç—Ç–∏–º email –∏ –ø–∞—Ä–æ–ª–µ–º.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SQL –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è

–í **Supabase SQL Editor**:

```sql
-- –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
-- –ó–ê–ú–ï–ù–ò–¢–ï your-email@example.com –Ω–∞ –≤–∞—à email
INSERT INTO auth.users (
  id,
  email,
  encrypted_password,
  email_confirmed_at,
  created_at,
  updated_at,
  instance_id,
  aud,
  role,
  raw_app_meta_data,
  raw_user_meta_data
) VALUES (
  gen_random_uuid(),
  'your-email@example.com',
  crypt('TestPassword123!', gen_salt('bf')), -- –ü–∞—Ä–æ–ª—å: TestPassword123!
  NOW(),
  NOW(),
  NOW(),
  '00000000-0000-0000-0000-000000000000',
  'authenticated',
  'authenticated',
  '{"provider": "email", "providers": ["email"]}',
  '{}'
)
RETURNING id, email;
```

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π email, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–∏–≤—è–∑–∞—Ç—å –∫ –Ω–µ–º—É –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ.

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤–æ–π–¥–∏—Ç–µ —Å –ø–∞—Ä–æ–ª–µ–º `TestPassword123!`

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

–û—Ç–º–µ—Ç—å—Ç–µ, —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏–ª–∏:

- [ ] Site URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (https://app.orbo.ru)
- [ ] Redirect URLs –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [ ] Email Provider –≤–∫–ª—é—á–µ–Ω
- [ ] Email Auth –≤–∫–ª—é—á–µ–Ω
- [ ] SMTP –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –æ—Ç–∫–ª—é—á–µ–Ω Custom SMTP
- [ ] Cookies –æ—á–∏—â–µ–Ω—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ Network –≤ DevTools
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ Supabase Auth Logs
- [ ] –ó–∞–ø—É—Å—Ç–∏–ª–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π SQL —Å–∫—Ä–∏–ø—Ç

---

## üìû –ß—Ç–æ –º–Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å, –µ—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ

1. **–°–∫—Ä–∏–Ω—à–æ—Ç—ã:**
   - Settings ‚Üí Auth ‚Üí URL Configuration
   - Authentication ‚Üí Providers (Email —Å–µ–∫—Ü–∏—è)
   - Settings ‚Üí Auth ‚Üí SMTP Settings

2. **–¢–µ–∫—Å—Ç –æ—à–∏–±–æ–∫:**
   - –ò–∑ Browser DevTools Network Response
   - –ò–∑ Supabase Auth Logs

3. **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:**
   - –°–∫—Ä–∏–Ω—à–æ—Ç Notice –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `DIAGNOSE_SIGNUP_ISSUE.sql`

---

## üìö –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –¥–µ—Ç–∞–ª—å–Ω–æ:
- **[SIGNUP_QUICK_FIX.md](./SIGNUP_QUICK_FIX.md)** - –ü–æ—à–∞–≥–æ–≤–æ–µ –±—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- **[SIGNUP_ERROR_FIX.md](./SIGNUP_ERROR_FIX.md)** - –í—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è

---

**–ù–∞—á–Ω–∏—Ç–µ —Å –®–∞–≥–∞ 1-4 –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å! ‚è±Ô∏è 5 –º–∏–Ω—É—Ç**

–ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–∂–µ—Ç ‚Üí –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –®–∞–≥ 5 –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

