# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ Telegram Chat ID

## –ü—Ä–æ–±–ª–µ–º–∞

–ö–æ–≥–¥–∞ Telegram –≥—Ä—É–ø–ø–∞ –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è "supergroup", Telegram –º–µ–Ω—è–µ—Ç –µ—ë `chat_id`:
- **–°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç:** `-4962287234` (–æ–±—ã—á–Ω–∞—è –≥—Ä—É–ø–ø–∞)
- **–ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç:** `-1002855950299` (supergroup —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `-100`)

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é –∑–∞–ø–∏—Å–µ–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

## –†–µ—à–µ–Ω–∏–µ

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ü—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≥—Ä—É–ø–ø —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—é –∏ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ:
- –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø" –≤ `/app/[org]/telegram`
- –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –¥—É–±–ª—å –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –≥—Ä—É–ø–ø—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–µ—Å—ë—Ç –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### 2. –†—É—á–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ API

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –≥—Ä—É–ø–ø—É:

```bash
POST /api/telegram/groups/migrate-chat
Content-Type: application/json

{
  "oldChatId": -4962287234,
  "newChatId": -1002855950299
}
```

### 3. –†—É—á–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ SQL

#### –®–∞–≥ 1: –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é —Ñ—É–Ω–∫—Ü–∏–∏

```sql
-- –í Supabase SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
-- db/migrations/069_handle_chat_migration.sql
```

#### –®–∞–≥ 2: –û—á–∏—Å—Ç–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥—É–±–ª—å

–î–ª—è –≥—Ä—É–ø–ø—ã "Do it, with Hegaiüòé":

```sql
-- –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ Supabase SQL Editor:
-- db/cleanup_duplicate_group_do_it_with_hegai.sql
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞–ø—Ä—è–º—É—é:

```sql
SELECT migrate_telegram_chat_id(-4962287234, -1002855950299);
```

## –ß—Ç–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏?

1. **–°–≤—è–∑–∏ —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º–∏** (`org_telegram_groups`)
2. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –≥—Ä—É–ø–ø—ã** (`telegram_group_admins`)
3. **–£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥—Ä—É–ø–ø—ã** (`participant_groups`)
4. **–ò—Å—Ç–æ—Ä–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏** (`activity_events`)

–°—Ç–∞—Ä–∞—è –∑–∞–ø–∏—Å—å –≥—Ä—É–ø–ø—ã —É–¥–∞–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç?

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –¥—É–±–ª—å —É–¥–∞–ª—ë–Ω
SELECT * FROM telegram_groups 
WHERE title LIKE '%Do it, with Hegai%';

-- –î–æ–ª–∂–Ω–∞ –æ—Å—Ç–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å —Å –Ω–æ–≤—ã–º chat_id

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –º–∏–≥—Ä–∞—Ü–∏–π
SELECT * FROM telegram_chat_migrations 
ORDER BY migrated_at DESC;
```

## –õ–æ–≥–∏–∫–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–∏

–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—é –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º:
1. –î–≤–µ –≥—Ä—É–ø–ø—ã —Å **–æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º**
2. –†–∞–∑–Ω—ã–µ `chat_id`
3. –ù–æ–≤—ã–π `chat_id` –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `-100`
4. –°—Ç–∞—Ä—ã–π `chat_id` –ù–ï –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `-100`

## –û–±—Ä–∞—Ç–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

–ï—Å–ª–∏ –±–æ—Ç —Ç–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ –≥—Ä—É–ø–ø–∞ —Å–Ω–æ–≤–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ–±—ã—á–Ω–æ–π:
- Telegram **–Ω–µ** –º–µ–Ω—è–µ—Ç `chat_id` –æ–±—Ä–∞—Ç–Ω–æ
- –ì—Ä—É–ø–ø–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç supergroup `chat_id` —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `-100`
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

## –¢–∞–±–ª–∏—Ü–∞ –º–∏–≥—Ä–∞—Ü–∏–π

–í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `telegram_chat_migrations`:

```sql
CREATE TABLE telegram_chat_migrations (
  id SERIAL PRIMARY KEY,
  old_chat_id BIGINT NOT NULL,
  new_chat_id BIGINT NOT NULL,
  migrated_at TIMESTAMPTZ DEFAULT NOW(),
  migration_result JSONB,
  UNIQUE(old_chat_id, new_chat_id)
);
```

–†–µ–∑—É–ª—å—Ç–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç:
- `success`: —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
- `moved_orgs`: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–Ω–µ—Å—ë–Ω–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
- `moved_admins`: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–Ω–µ—Å—ë–Ω–Ω—ã—Ö –∞–¥–º–∏–Ω–æ–≤
- `moved_participants`: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–Ω–µ—Å—ë–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- `moved_activities`: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–Ω–µ—Å—ë–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏



