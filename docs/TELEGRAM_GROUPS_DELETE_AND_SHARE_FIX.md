# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å Telegram –≥—Ä—É–ø–ø–∞–º–∏

## –î–∞—Ç–∞: 10.10.2025

## –û–±–∑–æ—Ä –ø—Ä–æ–±–ª–µ–º

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª –æ –¥–≤—É—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö –≤ —Ä–∞–±–æ—Ç–µ —Å Telegram –≥—Ä—É–ø–ø–∞–º–∏:

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –£–¥–∞–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø—ã –∏–∑ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–°–∏–º–ø—Ç–æ–º—ã**:
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –≥—Ä—É–ø–ø—ã –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "—É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞"
- –ù–æ –≥—Ä—É–ø–ø–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –ª–µ–≤–æ–º –º–µ–Ω—é
- –ì—Ä—É–ø–ø–∞ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º —É–¥–∞–ª–µ–Ω–∏–∏ –æ—à–∏–±–∫–∞ "Group is already archived for this organization"

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**:
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –≥—Ä—É–ø–ø–∞ –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ –ª–µ–≤–æ–≥–æ –º–µ–Ω—é
- –ì—Ä—É–ø–ø–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≥—Ä—É–ø–ø
- –ì—Ä—É–ø–ø—É –º–æ–∂–Ω–æ —Å–Ω–æ–≤–∞ –¥–æ–±–∞–≤–∏—Ç—å –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ –≥—Ä—É–ø–ø–∞—Ö" –¥–ª—è —Å–æ–±—ã—Ç–∏–π
**–°–∏–º–ø—Ç–æ–º—ã**:
- –ö–Ω–æ–ø–∫–∞ –∏–Ω–æ–≥–¥–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –¥–∞–∂–µ –µ—Å–ª–∏ —É –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –µ—Å—Ç—å –≥—Ä—É–ø–ø—ã (–≤–∏–¥–Ω—ã –≤ –ª–µ–≤–æ–º –º–µ–Ω—é)
- –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç—Å—è –Ω–µ –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≥—Ä—É–ø–ø—ã

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**:
- –ö–Ω–æ–ø–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è, –µ—Å–ª–∏ —É –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –µ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã
- –í —Å–ø–∏—Å–∫–µ –¥–ª—è sharing –≤—Å–µ –≥—Ä—É–ø–ø—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å `bot_status='connected'`

---

## –ü—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–∏—á–∏–Ω–∞ 1: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç RLS –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è DELETE
**–§–∞–π–ª**: `db/migrations/05_org_telegram_groups.sql`

–í —Ç–∞–±–ª–∏—Ü–µ `org_telegram_groups` –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –ø–æ–ª–∏—Ç–∏–∫–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è `SELECT` –∏ `INSERT`, –Ω–æ **–Ω–µ –¥–ª—è DELETE**:

```sql
-- ‚úÖ –ï—Å—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è SELECT
create policy org_telegram_groups_read on public.org_telegram_groups
  for select using (public.is_org_member(org_id));

-- ‚úÖ –ï—Å—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è INSERT
create policy org_telegram_groups_write on public.org_telegram_groups
  for insert with check (...);

-- ‚ùå –ù–ï–¢ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è DELETE!
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: 
- –û–ø–µ—Ä–∞—Ü–∏—è `DELETE` –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å –±–µ–∑ RLS –ø—Ä–æ–≤–µ—Ä–∫–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—ã—á–Ω–æ–≥–æ Supabase client (–Ω–µ admin) –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–æ —É–¥–∞–ª–µ–Ω–∏–µ
- –ó–∞–ø–∏—Å—å –Ω–µ —É–¥–∞–ª—è–ª–∞—Å—å, –Ω–æ –æ—à–∏–±–∫–∞ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞—Å—å

### –ü—Ä–∏—á–∏–Ω–∞ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–µ–π —Å—Ö–µ–º—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≥—Ä—É–ø–ø
**–§–∞–π–ª**: `app/app/[org]/events/[id]/page.tsx`

–ì—Ä—É–ø–ø—ã –¥–ª—è —Å–æ–±—ã—Ç–∏—è –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å –ø–æ —Å—Ç–∞—Ä–æ–π —Å—Ö–µ–º–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `org_id`:

```typescript
// ‚ùå –°—Ç–∞—Ä—ã–π –∫–æ–¥
const { data } = await supabase
  .from('telegram_groups')
  .select('id, tg_chat_id, title')
  .eq('org_id', params.org)  // –£—Å—Ç–∞—Ä–µ–≤—à–∏–π —Ñ–∏–ª—å—Ç—Ä!
  .eq('bot_status', 'connected')
```

**–ü—Ä–æ–±–ª–µ–º–∞**:
- –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ many-to-many —Å—Ö–µ–º—É (`org_telegram_groups`), –∫–æ–ª–æ–Ω–∫–∞ `org_id` –≤ `telegram_groups` –±–æ–ª—å—à–µ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- –ì—Ä—É–ø–ø—ã, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –Ω–æ–≤—É—é —Å—Ö–µ–º—É, –Ω–µ –ø–æ–ø–∞–¥–∞–ª–∏ –≤ –≤—ã–±–æ—Ä–∫—É
- –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∞—Å—å –∏–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –Ω–µ–ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫

---

## –†–µ—à–µ–Ω–∏–µ

### 1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ RLS –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è DELETE

**–ù–æ–≤—ã–π —Ñ–∞–π–ª**: `db/migrations/29_org_telegram_groups_delete_policy.sql`

```sql
-- Add DELETE policy for org_telegram_groups
-- Allow admins/owners to delete (unlink) mappings for their org

do $$
begin
  if not exists (
    select 1 from pg_policies
    where schemaname = 'public'
      and tablename = 'org_telegram_groups'
      and policyname = 'org_telegram_groups_delete'
  ) then
    create policy org_telegram_groups_delete on public.org_telegram_groups
      for delete using (
        exists (
          select 1 from public.memberships m
          where m.org_id = org_telegram_groups.org_id
            and m.user_id = auth.uid()
            and m.role in ('owner','admin')
        )
      );
  end if;
end$$;
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**:
- –†–∞–∑—Ä–µ—à–∞–µ—Ç DELETE —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª—å—Ü–∞–º –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç membership —á–µ—Ä–µ–∑ `auth.uid()`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–æ–ª–∏ 'owner' –∏ 'admin'

### 2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è deleteGroup

**–§–∞–π–ª**: `app/app/[org]/telegram/actions.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
1. –î–æ–±–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `createAdminServer()` –¥–ª—è –æ–±—Ö–æ–¥–∞ RLS
2. –î–æ–±–∞–≤–ª–µ–Ω–∞ —è–≤–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è `tg_chat_id` –∫ —Å—Ç—Ä–æ–∫–µ
3. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
4. –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ë—ã–ª–æ**:
```typescript
export async function deleteGroup(formData: FormData) {
  'use server'
  
  const org = String(formData.get('org'))
  const groupId = Number(formData.get('groupId'))
  
  try {
    const { supabase } = await requireOrgAccess(org)  // ‚ùå –û–±—ã—á–Ω—ã–π –∫–ª–∏–µ–Ω—Ç
    
    const { error: deleteError } = await supabase    // ‚ùå RLS –±–ª–æ–∫–∏—Ä—É–µ—Ç
      .from('org_telegram_groups')
      .delete()
      .eq('org_id', org)
      .eq('tg_chat_id', existingGroup.tg_chat_id)
    
    return  // ‚ùå –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  } catch (error) {
    return  // ‚ùå –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É
  }
}
```

**–°—Ç–∞–ª–æ**:
```typescript
export async function deleteGroup(formData: FormData) {
  'use server'
  
  const org = String(formData.get('org'))
  const groupId = Number(formData.get('groupId'))
  
  if (!groupId || isNaN(groupId)) {
    return { error: 'Invalid group ID' }  // ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—à–∏–±–∫—É
  }
  
  try {
    const { supabase } = await requireOrgAccess(org)
    const adminSupabase = createAdminServer()  // ‚úÖ Admin –∫–ª–∏–µ–Ω—Ç
    
    console.log(`Deleting group ${groupId} from organization ${org}`)
    
    // –ü–æ–ª—É—á–∞–µ–º –≥—Ä—É–ø–ø—É –∏—Å–ø–æ–ª—å–∑—É—è admin client
    const { data: existingGroup, error: fetchError } = await adminSupabase
      .from('telegram_groups')
      .select('id, tg_chat_id, org_id')
      .eq('id', groupId)
      .single()
    
    if (fetchError || !existingGroup) {
      return { error: 'Group not found' }  // ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—à–∏–±–∫—É
    }
    
    const tgChatIdStr = String(existingGroup.tg_chat_id)  // ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Å—Ç—Ä–æ–∫—É
    console.log(`Deleting mapping for org ${org}, tg_chat_id ${tgChatIdStr}`)
    
    // –£–¥–∞–ª—è–µ–º —Å–≤—è–∑—å –∏—Å–ø–æ–ª—å–∑—É—è admin client
    const { error: deleteError } = await adminSupabase  // ‚úÖ Admin –∫–ª–∏–µ–Ω—Ç –æ–±—Ö–æ–¥–∏—Ç RLS
      .from('org_telegram_groups')
      .delete()
      .eq('org_id', org)
      .eq('tg_chat_id', tgChatIdStr)
    
    if (deleteError) {
      console.error('Error deleting org-group link:', deleteError)
      return { error: 'Failed to delete group mapping: ' + deleteError.message }
    }
    
    console.log(`Successfully deleted mapping for group ${groupId}`)
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –≥—Ä—É–ø–ø–∞ –¥—Ä—É–≥–∏–º–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º–∏
    const { data: otherLinks } = await adminSupabase
      .from('org_telegram_groups')
      .select('org_id')
      .eq('tg_chat_id', tgChatIdStr)
      .limit(1)
    
    // –ï—Å–ª–∏ –≥—Ä—É–ø–ø–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, —É–±–∏—Ä–∞–µ–º org_id (legacy)
    if (!otherLinks || otherLinks.length === 0) {
      if (existingGroup.org_id === org) {
        await adminSupabase
          .from('telegram_groups')
          .update({ org_id: null })
          .eq('id', groupId)
        console.log(`Cleared org_id for group ${groupId}`)
      }
    }
    
    return { success: true }  // ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ–º —É—Å–ø–µ—Ö
  } catch (error: any) {
    console.error('Error deleting group:', error)
    return { error: error.message || 'Failed to delete group' }  // ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—à–∏–±–∫—É
  }
}
```

### 3. ‚úÖ –°–æ–∑–¥–∞–Ω –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç DeleteGroupButton

**–ù–æ–≤—ã–π —Ñ–∞–π–ª**: `app/app/[org]/telegram/delete-group-button.tsx`

–ü—Ä–æ–±–ª–µ–º–∞ —Å —Ñ–æ—Ä–º–æ–π:
```typescript
// ‚ùå Server Action –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
<form action={async (formData) => {
  await deleteGroup(formData);
}}>
  <button type="submit">–£–¥–∞–ª–∏—Ç—å</button>
</form>
```

–†–µ—à–µ–Ω–∏–µ - –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:
```typescript
'use client'

import { useState, useTransition } from 'react'
import { useRouter } from 'next/navigation'
import { deleteGroup } from './actions'

export function DeleteGroupButton({ groupId, groupTitle, orgId }: Props) {
  const router = useRouter()
  const [isPending, startTransition] = useTransition()
  const [error, setError] = useState<string | null>(null)

  const handleDelete = () => {
    if (!confirm(`–£–¥–∞–ª–∏—Ç—å –≥—Ä—É–ø–ø—É "${groupTitle}"?`)) {
      return
    }

    startTransition(async () => {
      const formData = new FormData()
      formData.append('org', orgId)
      formData.append('groupId', groupId.toString())

      const result = await deleteGroup(formData)

      if (result?.error) {
        setError(result.error)  // ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
        return
      }

      router.refresh()  // ‚úÖ –û–±–Ω–æ–≤–ª—è–µ–º UI
    })
  }

  return (
    <div>
      <button onClick={handleDelete} disabled={isPending}>
        {isPending ? '–£–¥–∞–ª–µ–Ω–∏–µ...' : '–£–¥–∞–ª–∏—Ç—å'}
      </button>
      {error && <div className="text-red-600">{error}</div>}
    </div>
  )
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç Server Action
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç UI —á–µ—Ä–µ–∑ `router.refresh()`
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º

### 4. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ Telegram

**–§–∞–π–ª**: `app/app/[org]/telegram/page.tsx`

**–ë—ã–ª–æ**:
```typescript
<form action={async (formData) => {
  await deleteGroup(formData);
}}>
  <button type="submit">–£–¥–∞–ª–∏—Ç—å</button>
</form>
```

**–°—Ç–∞–ª–æ**:
```typescript
<DeleteGroupButton
  groupId={group.id}
  groupTitle={group.title}
  orgId={params.org}
/>
```

### 5. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ –≥—Ä—É–ø–ø –¥–ª—è —Å–æ–±—ã—Ç–∏—è

**–§–∞–π–ª**: `app/app/[org]/events/[id]/page.tsx` (—Å—Ç—Ä–æ–∫–∏ 111-140)

**–ë—ã–ª–æ**:
```typescript
// ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–µ–π —Å—Ö–µ–º—ã
let telegramGroups: any[] = []
if (isAdmin) {
  const { data } = await supabase
    .from('telegram_groups')
    .select('id, tg_chat_id, title')
    .eq('org_id', params.org)  // ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å org_telegram_groups
    .eq('bot_status', 'connected')
    .order('title')
  
  telegramGroups = data || []
}
```

**–°—Ç–∞–ª–æ**:
```typescript
// ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π many-to-many —Å—Ö–µ–º—ã
let telegramGroups: any[] = []
if (isAdmin) {
  // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ org_telegram_groups
  const { data: orgGroupsData } = await adminSupabase
    .from('org_telegram_groups')
    .select(`
      telegram_groups!inner (
        id,
        tg_chat_id,
        title,
        bot_status
      )
    `)
    .eq('org_id', params.org)
  
  if (orgGroupsData) {
    // –ò–∑–≤–ª–µ–∫–∞–µ–º telegram_groups –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ JOIN
    telegramGroups = (orgGroupsData as any[])
      .map((item: any) => item.telegram_groups)
      .filter((group: any) => group !== null && group.bot_status === 'connected')
      .sort((a: any, b: any) => {
        const titleA = a.title || ''
        const titleB = b.title || ''
        return titleA.localeCompare(titleB)
      })
  }
  
  console.log(`Loaded ${telegramGroups.length} connected telegram groups for event sharing`)
}
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `org_telegram_groups` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
2. ‚úÖ JOIN —Å `telegram_groups` —á–µ—Ä–µ–∑ `!inner`
3. ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ nested —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
4. ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `bot_status === 'connected'`
5. ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `title`
6. ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø

---

## –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|-----------|
| `db/migrations/29_org_telegram_groups_delete_policy.sql` | ‚úÖ **–°–æ–∑–¥–∞–Ω** - RLS –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è DELETE |
| `app/app/[org]/telegram/actions.ts` | ‚úÖ –§—É–Ω–∫—Ü–∏—è `deleteGroup` - admin client, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, –≤–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ |
| `app/app/[org]/telegram/delete-group-button.tsx` | ‚úÖ **–°–æ–∑–¥–∞–Ω** - –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏ `router.refresh()` |
| `app/app/[org]/telegram/page.tsx` | ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `DeleteGroupButton` –≤–º–µ—Å—Ç–æ —Ñ–æ—Ä–º—ã, —É–¥–∞–ª–µ–Ω –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏–º–ø–æ—Ä—Ç |
| `app/app/[org]/events/[id]/page.tsx` | ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä—É–ø–ø —á–µ—Ä–µ–∑ `org_telegram_groups` –≤–º–µ—Å—Ç–æ `org_id` |

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ–ø–µ—Ä—å

### Flow —É–¥–∞–ª–µ–Ω–∏—è –≥—Ä—É–ø–ø—ã:

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç "–£–¥–∞–ª–∏—Ç—å"**
   - `DeleteGroupButton` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç confirm –¥–∏–∞–ª–æ–≥

2. **–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è**
   - –°–æ–∑–¥–∞–µ—Ç—Å—è `FormData` —Å `orgId` –∏ `groupId`
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è Server Action `deleteGroup(formData)`

3. **Server Action `deleteGroup`**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ `requireOrgAccess`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `adminSupabase` –¥–ª—è –æ–±—Ö–æ–¥–∞ RLS
   - –ü–æ–ª—É—á–∞–µ—Ç `tg_chat_id` –≥—Ä—É–ø–ø—ã
   - –£–¥–∞–ª—è–µ—Ç –∑–∞–ø–∏—Å—å –∏–∑ `org_telegram_groups`
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –≥—Ä—É–ø–ø–∞ –¥—Ä—É–≥–∏–º–∏ org
   - –ï—Å–ª–∏ –Ω–µ—Ç - –æ—á–∏—â–∞–µ—Ç `org_id` –≤ `telegram_groups` (legacy)
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{ success: true }` –∏–ª–∏ `{ error: string }`

4. **DeleteGroupButton –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç**
   - –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –µ—ë –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   - –ï—Å–ª–∏ —É—Å–ø–µ—Ö - –≤—ã–∑—ã–≤–∞–µ—Ç `router.refresh()`

5. **`router.refresh()` –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ**
   - –°–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `TelegramPage` –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞–µ—Ç—Å—è
   - –ì—Ä—É–ø–ø—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ —á–µ—Ä–µ–∑ `org_telegram_groups`
   - –£–¥–∞–ª–µ–Ω–Ω–∞—è –≥—Ä—É–ø–ø–∞ –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ —Å–ø–∏—Å–∫–∞
   - –ì—Ä—É–ø–ø–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ "Available groups"

### Flow –∑–∞–≥—Ä—É–∑–∫–∏ –≥—Ä—É–ø–ø –¥–ª—è —Å–æ–±—ã—Ç–∏—è:

1. **–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ–±—ã—Ç–∏—è**
   - `app/app/[org]/events/[id]/page.tsx` (Server Component)

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤**
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å admin/owner

3. **–ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä—É–ø–ø**
   - –ó–∞–ø—Ä–æ—Å –∫ `org_telegram_groups` —Å JOIN –Ω–∞ `telegram_groups`
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `org_id` –∏ `bot_status='connected'`
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `title`

4. **–ü–µ—Ä–µ–¥–∞—á–∞ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç**
   - `<EventDetail telegramGroups={telegramGroups} />`

5. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏**
   - –ï—Å–ª–∏ `telegramGroups.length > 0` - –∫–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
   - –í –¥–∏–∞–ª–æ–≥–µ sharing –≤—Å–µ –≥—Ä—É–ø–ø—ã –∏–∑ `telegramGroups`

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≥—Ä—É–ø–ø—ã:

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞**:
   - [ ] –î–æ–±–∞–≤—å—Ç–µ Telegram –≥—Ä—É–ø–ø—É –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é
   - [ ] –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≥—Ä—É–ø–ø–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –ª–µ–≤–æ–º –º–µ–Ω—é

2. **–£–¥–∞–ª–µ–Ω–∏–µ**:
   - [ ] –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/app/[org]/telegram`
   - [ ] –ù–∞–∂–º–∏—Ç–µ "–£–¥–∞–ª–∏—Ç—å" –Ω–∞ –≥—Ä—É–ø–ø–µ
   - [ ] –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤ confirm –¥–∏–∞–ª–æ–≥–µ

3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
   - [ ] –ì—Ä—É–ø–ø–∞ –∏—Å—á–µ–∑–ª–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
   - [ ] –ì—Ä—É–ø–ø–∞ –∏—Å—á–µ–∑–ª–∞ –∏–∑ –ª–µ–≤–æ–≥–æ –º–µ–Ω—é
   - [ ] –ì—Ä—É–ø–ø–∞ –ø–æ—è–≤–∏–ª–∞—Å—å –≤ "Available groups" (`/app/[org]/telegram/available-groups`)
   - [ ] –ì—Ä—É–ø–ø—É –º–æ–∂–Ω–æ —Å–Ω–æ–≤–∞ –¥–æ–±–∞–≤–∏—Ç—å –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é

4. **–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ**:
   - [ ] –î–æ–±–∞–≤—å—Ç–µ –≥—Ä—É–ø–ø—É –æ–±—Ä–∞—Ç–Ω–æ
   - [ ] –ì—Ä—É–ø–ø–∞ –ø–æ—è–≤–∏–ª–∞—Å—å –≤ –ª–µ–≤–æ–º –º–µ–Ω—é
   - [ ] –ì—Ä—É–ø–ø–∞ –∏—Å—á–µ–∑–ª–∞ –∏–∑ "Available groups"

### –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è":

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞**:
   - [ ] –°–æ–∑–¥–∞–π—Ç–µ —Å–æ–±—ã—Ç–∏–µ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "published"
   - [ ] –î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É Telegram –≥—Ä—É–ø–ø—É –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é
   - [ ] –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≥—Ä—É–ø–ø–∞ –∏–º–µ–µ—Ç `bot_status='connected'`

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è**:
   - [ ] –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–æ–±—ã—Ç–∏—è (`/app/[org]/events/[id]`)
   - [ ] –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ –≥—Ä—É–ø–ø–∞—Ö" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
   - [ ] –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–∏—Å–∫–∞ –≥—Ä—É–ø–ø**:
   - [ ] –í –¥–∏–∞–ª–æ–≥–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤—Å–µ –≥—Ä—É–ø–ø—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
   - [ ] –ì—Ä—É–ø–ø—ã —Å `bot_status='connected'` –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
   - [ ] –ì—Ä—É–ø–ø—ã —Å `bot_status='pending'` –∏–ª–∏ `'inactive'` –ù–ï –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

4. **–ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è**:
   - [ ] –í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É(—ã)
   - [ ] –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å"
   - [ ] –°–æ–±—ã—Ç–∏–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø–∞—Ö

---

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: –ì—Ä—É–ø–ø–∞ –≤—Å–µ –µ—â–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è

**–ü—Ä–∏—á–∏–Ω—ã**:
1. –ö—ç—à –±—Ä–∞—É–∑–µ—Ä–∞
2. `router.refresh()` –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª

**–†–µ—à–µ–Ω–∏–µ**:
1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Network ‚Üí –æ—Ç–∫–ª—é—á–∏—Ç–µ –∫—ç—à
2. Hard refresh (Ctrl+Shift+R)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Vercel Logs –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ "Failed to delete group mapping"

**–ü—Ä–∏—á–∏–Ω—ã**:
1. –ú–∏–≥—Ä–∞—Ü–∏—è `29_org_telegram_groups_delete_policy.sql` –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
2. RLS –ø–æ–ª–∏—Ç–∏–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ**:
```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏
SELECT * FROM pg_policies 
WHERE tablename = 'org_telegram_groups' 
  AND policyname = 'org_telegram_groups_delete';

-- –ï—Å–ª–∏ –Ω–µ—Ç - –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é
\i db/migrations/29_org_telegram_groups_delete_policy.sql
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω—ã**:
1. `telegramGroups.length === 0`
2. –ì—Ä—É–ø–ø—ã –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**:
```typescript
// –í app/app/[org]/events/[id]/page.tsx –¥–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
console.log('Loaded telegram groups:', telegramGroups)
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Vercel Logs:
- –ï—Å–ª–∏ "Loaded 0 connected telegram groups" - –≥—Ä—É–ø–ø—ã –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≥—Ä—É–ø–ø—ã –µ—Å—Ç—å –≤ `org_telegram_groups`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `bot_status='connected'`

### –ü—Ä–æ–±–ª–µ–º–∞: –í —Å–ø–∏—Å–∫–µ –¥–ª—è sharing –Ω–µ –≤—Å–µ –≥—Ä—É–ø–ø—ã

**–ü—Ä–∏—á–∏–Ω—ã**:
1. –ì—Ä—É–ø–ø—ã –∏–º–µ—é—Ç `bot_status != 'connected'`
2. –ì—Ä—É–ø–ø—ã –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `org_telegram_groups`

**–†–µ—à–µ–Ω–∏–µ**:
```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥—Ä—É–ø–ø—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
SELECT 
  tg.id,
  tg.title,
  tg.bot_status,
  otg.org_id
FROM telegram_groups tg
JOIN org_telegram_groups otg ON tg.tg_chat_id = otg.tg_chat_id
WHERE otg.org_id = 'YOUR_ORG_ID';
```

–ï—Å–ª–∏ `bot_status != 'connected'`:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ —Å—Ç–∞—Ç—É—Å: `/api/telegram/bot/refresh-group`

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

### Many-to-Many —Å—Ö–µ–º–∞ —Å org_telegram_groups

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –û–¥–Ω–∞ –≥—Ä—É–ø–ø–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å —Å–≤—è–∑—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è `telegram_groups`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (created_by, created_at, status)

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**:
- –¢—Ä–µ–±—É–µ—Ç—Å—è JOIN –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≥—Ä—É–ø–ø
- –°–ª–æ–∂–Ω–µ–µ –º–∏–≥—Ä–∞—Ü–∏—è —Å–æ —Å—Ç–∞—Ä–æ–π —Å—Ö–µ–º—ã

**Legacy –ø–æ–¥–¥–µ—Ä–∂–∫–∞**:
- –ö–æ–ª–æ–Ω–∫–∞ `org_id` –≤ `telegram_groups` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- –û—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–≤—è–∑–∏
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤ –Ω–æ–≤–æ–º –∫–æ–¥–µ

### RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è org_telegram_groups

**–¢–µ–∫—É—â–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏**:
```sql
-- SELECT: –í—Å–µ —á–ª–µ–Ω—ã org –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å
org_telegram_groups_read: is_org_member(org_id)

-- INSERT: –¢–æ–ª—å–∫–æ admin/owner –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å
org_telegram_groups_write: role in ('owner', 'admin')

-- DELETE: –¢–æ–ª—å–∫–æ admin/owner –º–æ–≥—É—Ç —É–¥–∞–ª—è—Ç—å
org_telegram_groups_delete: role in ('owner', 'admin')
```

**–ü–æ—á–µ–º—É –Ω–µ—Ç UPDATE**:
- –¢–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤—è–∑–∏ (org_id, tg_chat_id)
- UPDATE –Ω–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª–∞ –¥–ª—è —Å–≤—è–∑–µ–π
- –î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω—É–∂–Ω–æ DELETE + INSERT

---

## –°—Ç–∞—Ç—É—Å

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é**  
üìÖ **–î–∞—Ç–∞**: 10.10.2025  
üîç **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±–∞ flow (—É–¥–∞–ª–µ–Ω–∏–µ –∏ sharing)  
üìä **–û—à–∏–±–æ–∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏**: –ù–µ—Ç  
üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 
- –£–¥–∞–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø—ã —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º UI
- –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –≥—Ä—É–ø–ø –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

---

**–ê–≤—Ç–æ—Ä**: AI Assistant  
**–í–µ—Ä—Å–∏—è**: 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 10.10.2025

