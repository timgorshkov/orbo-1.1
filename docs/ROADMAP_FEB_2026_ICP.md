# Роадмап: Февраль 2026 — "События как конверсионный движок"

**Дата:** 6 февраля 2026
**Контекст:** Обновлённый роадмап на основе ICP Canvas (docs/icp_canvas_orbo_с_miniapp_гипотезами.md)
**Статус:** В работе

---

## Стратегический контекст

### Ключевая рамка из ICP Canvas:
> Orbo — это слой оцифровки участия людей в событиях и жизни сообщества

### Приоритетные ICP:
1. **ICP-A** (основной фокус) — владельцы сообществ с регулярными мероприятиями и монетизацией
2. **ICP-B** (масштаб) — малые сообщества без команды
3. **ICP-C** (эксперимент) — авторы Telegram-каналов

### Главная боль ICP-A:
> Сложно стабильно собирать людей и деньги на мероприятия без ручной суеты и потерь.

### Продуктовая гипотеза:
> Miniapp + бот как конверсионный слой для мероприятий, повышающий заявки, доходимость и выручку.

---

## Текущее состояние (обновлено 9 февраля 2026)

### Что построено в событиях (98%):
| Функция | Статус | Комментарий |
|---------|--------|-------------|
| CRUD событий | ✅ | Полный цикл, включая удаление |
| Регистрация с кастомными полями | ✅ | Включая multiple tickets |
| Telegram MiniApp для регистрации | ✅ | `@orbo_event_bot` |
| Учёт оплат (ручной) | ✅ | Статусы, суммы, методы |
| QR check-in | ✅ | Генерация токенов, опциональность (настройка enable_qr_checkin) |
| Ручной check-in для админов | ✅ | Кнопка "Отметить" в списке участников |
| Публичные/приватные события | ✅ | |
| ICS экспорт | ✅ | Корректная обработка дат и часовых поясов |
| Google Calendar экспорт | ✅ | Автозаполнение описания, ссылки, локации |
| Шеринг через Telegram | ✅ | Deep links, выбор miniapp/web ссылки в анонсах |
| Обложка события | ✅ | Drag & drop, upload |
| Многодневные события | ✅ | |
| Диаграмма регистраций на дашборде | ✅ | 30 дней, бары + линия оплат |

### Что построено в анонсах:
| Функция | Статус | Комментарий |
|---------|--------|-------------|
| Таблица `announcements` | ✅ | С event_id, reminder_type, target_groups |
| UI с календарём/списком/архивом | ✅ | `app/p/[org]/announcements/` |
| CRUD API | ✅ | Создание, редактирование, удаление |
| Cron для отправки | ✅ | `send-announcements` — раз в минуту |
| Авто-создание при событии | ✅ | `createEventReminders()` — 24ч и 1ч |
| Telegram-форматирование | ✅ | HTML с эмодзи |

### Что построено в напоминаниях:
| Функция | Бот | Комментарий |
|---------|-----|-------------|
| Ручная рассылка в группы | `@orbo_community_bot` | Кнопка "Уведомить" в карточке события |
| Cron групповые напоминания | `@orbo_community_bot` | `event-notifications` — 24ч и 1ч |
| Личные DM участникам | `@orbo_community_bot` | `send-event-reminders` — 24ч до |
| Регистрация через MiniApp | `@orbo_event_bot` | Deep link |

### Что построено в заявках:
| Функция | Статус | Комментарий |
|---------|--------|-------------|
| Pipeline (воронка) | ✅ | Kanban-доска со стадиями |
| Формы заявок | ✅ | Кастомные поля |
| Нативные TG join requests | ✅ | Через webhook |
| MiniApp для анкет | ✅ | `@orbo_community_bot` |
| Авто-одобрение через API | ⚠️ | Требует стабилизации |

### Что построено в инфраструктуре (новое, февраль 2026):
| Функция | Статус | Комментарий |
|---------|--------|-------------|
| Полное удаление Supabase | ✅ | PostgreSQL direct, Selectel S3, NextAuth.js only |
| Суперадмин-имперсонация | ✅ | Вход в любую организацию как виртуальный owner |
| Авто-решение уведомлений | ✅ | Churning/inactive items закрываются при активности |
| Топик-анализ в группах | ✅ | Отдельный анализ негатива/вопросов по форум-топикам |
| Единая цветовая схема уведомлений | ✅ | 3 цвета (Red/Amber/Blue) |
| Защита данных между организациями | ✅ | Активность фильтруется по org_telegram_groups |
| AI-обогащение с контекстом | ✅ | Добавлены события, заявки, профиль участника |
| Онбординг-дашборд | ✅ | 5 шагов, адаптирован под ICP, скрытие онбординга |
| DevOps: PostgreSQL tuning | ✅ | Оптимизация буферов, ротация логов |
| DevOps: Security headers | ✅ | Nginx CSP, HSTS, X-Frame-Options |

### Известная проблема:
Существуют ДВЕ параллельные системы групповых напоминаний:
1. Старая: `event-notifications` cron → напрямую в группы
2. Новая: `announcements` cron → через таблицу анонсов

Нужно унифицировать: оставить только систему анонсов, удалить старый cron.

---

## Неделя 1-2: События — улучшения ядра + унификация напоминаний

### 1. История событий в профиле участника
**ICP-боль:** "Нет понимания, кто ходит регулярно" (ICP-A)

**Что делаем:**
- В карточке участника (вкладка "Активность" или новая "События") показывать:
  - Все события, на которые зарегистрирован
  - Статус: зарегистрирован / пришёл (check-in) / не пришёл / отменил
  - Статус оплаты
  - Дата регистрации
- Счётчик: "Посетил X из Y событий" (доходимость участника)
- Бейдж "Постоянный участник" если посетил ≥3 событий

**Источник данных:** таблица `event_registrations` (связь через `participant_id`)

### 2. Аналитика событий
**ICP-боль:** "Считают экономику мероприятий постфактум" (ICP-A)

**Что делаем:**
- На странице события (вкладка "Аналитика"):
  - Конверсия: зарегистрировались → оплатили → пришли
  - No-show rate (% не дошедших)
  - Средний чек (для платных)
  - Количество повторных участников (были на предыдущих событиях)
- На дашборде организации:
  - Общая статистика по событиям за период
  - Топ-участники по посещаемости

### 3. Унификация напоминаний через анонсы
**Принцип:** Все групповые напоминания о событиях должны проходить через систему анонсов.

**Что делаем:**
- При создании события автоматически создаются анонсы-напоминания (уже работает через `createEventReminders()`)
- Админ может зайти в раздел "Анонсы" и:
  - Редактировать текст автоматически созданных напоминаний
  - Изменить время отправки
  - Добавить дополнительные напоминания
  - Отменить ненужные
- Удалить старый cron `event-notifications` (дублирует функционал анонсов)
- Убедиться, что cron `send-announcements` корректно обрабатывает все типы
- Проверить и расширить формат авто-созданных анонсов (красивый шаблон)

### 4. Бот-напоминания участникам через @orbo_community_bot
**ICP-боль:** "Часть людей не доходит до события" (ICP-A, B)

**Что делаем:**
- Проверить и расширить логику личных DM (cron `send-event-reminders`):
  - Напоминание за 24 часа (уже есть) — проверить стабильность
  - Добавить напоминание за 1 час до события
  - Добавить напоминание об оплате (если не оплатил)
  - После события: "Спасибо за участие!" (если check-in) / "Жаль, что не получилось" (если no-show)
- Все напоминания через `@orbo_community_bot` (уже используется)
- Не спамить: проверять, что участник начал диалог с ботом

### 5. Стабилизация заявок
- Довести Telegram-одобрение до стабильной работы
- Закрыть оставшиеся баги (по мере поступления замечаний)

---

## Неделя 3-4: Анонсы MVP — усиление связи с событиями

### 6. Расширение UI анонсов
- Связь анонса с событием: при просмотре события видеть запланированные анонсы
- При создании события — чекбоксы: ☑️ Напоминание за 24ч, ☑️ За 1ч, ☐ За 3 дня
- Редактирование шаблонов напоминаний
- Архив: что было отправлено, когда, в какие группы

### 7. Ручные анонсы (не привязанные к событиям)
- Создание произвольных анонсов для рассылки в группы
- Планирование на конкретное время
- Telegram-форматирование: *жирный*, _курсив_, эмодзи

---

## Март 2026: "Деньги и масштабирование"

### Неделя 1-2: Оплата событий + повторяющиеся события
| Задача | ICP |
|--------|-----|
| Интеграция ЮKassa (автоматический приём оплат) | A |
| Повторяющиеся события (еженедельно, ежемесячно) | A, B |
| Шаблоны событий (клонирование) | A, B |
| Экспорт регистраций (CSV/Excel) | A |

### Неделя 3-4: Биллинг + Quick wins
| Задача | ICP |
|--------|-----|
| Биллинг инфраструктура (Trial 14 дней, тарифы) | Монетизация |
| Быстрое событие из Telegram (MiniApp для создания) | B |
| MiniApp-лидмагнит для авторов каналов | C |

---

## Апрель 2026 (перспектива)

| Задача | ICP |
|--------|-----|
| Каталог приложений + Votum | Экосистема |
| Роли сотрудников + Offboarding | B2B |
| Расширенная аналитика (когорты, прогноз оттока) | A |
| Фирменный MiniApp для сообщества | A, B |

---

## Что перенесено из предыдущего роадмапа (Фев-Март)

| Пункт | Было | Стало | Причина |
|-------|------|-------|---------|
| Каталог приложений + Votum | Февраль W1-2 | Апрель | ICP-A приоритет выше |
| Анонсы MVP | Февраль W3-4 | Февраль W3-4 | Остаётся, усилена связь с событиями |
| Роли сотрудников | Март W1-2 | Апрель | Не ICP-A приоритет |
| Биллинг | Март W3-4 | Март W3-4 | Остаётся |

---

## Архитектурные решения

### Боты и их роли:
| Бот | Для чего |
|-----|----------|
| `@orbo_community_bot` | Групповые уведомления, личные напоминания о событиях, регистрация через MiniApp |
| `@orbo_event_bot` | MiniApp регистрации на события (deep link) |
| `@orbo_assist_bot` | Системные уведомления (негатив, неактивность, вопросы) |

### Напоминания — единая система через анонсы:
```
Создание события
  → createEventReminders() создаёт записи в announcements
  → Админ может редактировать в разделе "Анонсы"
  → Cron send-announcements отправляет по расписанию в группы

Личные DM:
  → Cron send-event-reminders отправляет через @orbo_community_bot
  → 24ч и 1ч до события
  → После события: follow-up
```

### Удалить/деактивировать:
- `app/api/cron/event-notifications/route.ts` — заменяется системой анонсов

---

## Метрики успеха (февраль 2026)

| Метрика | Цель |
|---------|------|
| Доходимость до событий (check-in / registered) | Измерить baseline → +10% |
| Конверсия "анонс в группе → регистрация" | Измерить baseline |
| Организаций, использующих авто-напоминания | ≥ 5 |
| Участников, получивших личное напоминание | ≥ 50 |
| Средний no-show rate | Измерить baseline |

---

*Обновлено: 9 февраля 2026*
